services:
  # SmartStart Backend API
  - type: web
    name: smartstart-backend
    env: node
    plan: starter
    region: oregon
    buildCommand: |
      echo "ðŸš€ Building SmartStart Backend..."
      cd smartstart-platform/backend
      npm ci --cache .npm-cache --prefer-offline
      echo "âœ… Backend build complete"
    startCommand: cd smartstart-platform/backend && node src/server.js
    autoDeploy: true
    branch: main
    healthCheckPath: /health
    healthCheckGracePeriod: 300
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "3001"
      - key: DATABASE_URL
        fromDatabase:
          name: smartstart-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: CORS_ORIGINS
        value: "https://smartstart-website.onrender.com,https://smartstart-app.onrender.com,http://localhost:3000"

  # SmartStart Website (Public-facing)
  - type: web
    name: smartstart-website
    env: node
    plan: starter
    region: oregon
    buildCommand: |
      echo "ðŸš€ Building SmartStart Website..."
      cd smartstart-platform
      npm ci --cache .npm-cache --prefer-offline
      echo "âœ… Website build complete"
    startCommand: cd smartstart-platform && node website-server.js
    autoDeploy: true
    branch: main
    healthCheckPath: /
    healthCheckGracePeriod: 300
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "3000"
      - key: BACKEND_URL
        value: https://smartstart-backend.onrender.com

  # SmartStart App (Private dashboard)
  - type: web
    name: smartstart-app
    env: node
    plan: starter
    region: oregon
    buildCommand: |
      echo "ðŸš€ Building SmartStart App..."
      cd smartstart-platform
      npm ci --cache .npm-cache --prefer-offline
      echo "âœ… App build complete"
    startCommand: cd smartstart-platform && node server.js
    autoDeploy: true
    branch: main
    healthCheckPath: /health
    healthCheckGracePeriod: 300
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "3002"
      - key: BACKEND_URL
        value: https://smartstart-backend.onrender.com

  # WonderLand App (Separate application)
  - type: web
    name: wonderland-app
    env: node
    plan: starter
    region: oregon
    buildCommand: |
      echo "ðŸš€ Building WonderLand App..."
      cd WonderLand_app
      npm ci --cache .npm-cache --prefer-offline
      echo "âœ… WonderLand build complete"
    startCommand: cd WonderLand_app && node website-server.js
    autoDeploy: true
    branch: main
    healthCheckPath: /
    healthCheckGracePeriod: 300
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "3003"

databases:
  - name: smartstart-db
    plan: starter
    region: oregon
