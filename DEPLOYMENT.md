# SmartStart Platform - Complete Deployment Guide

## üöÄ **Complete AliceSolutions Hub Architecture**

This deployment includes a comprehensive full-stack platform with all services needed for the AliceSolutions Hub blueprint:

### **Services Included:**

1. **üìä PostgreSQL Database** (`smartstart-db`)
   - Complete schema with 44+ tables
   - RBAC system with roles and permissions
   - Equity tracking and cap table management
   - User management and authentication
   - Project management and collaboration

2. **üîå API Server** (`smartstart-api`)
   - Express.js REST API
   - JWT authentication and authorization
   - RBAC middleware with granular permissions
   - Database operations via Prisma ORM
   - External integrations (Stripe, GitHub, M365)
   - Background job scheduling

3. **‚öôÔ∏è Background Worker** (`smartstart-worker`)
   - Quarterly equity rebalancing
   - Dunning process (payment collection)
   - IT pack provisioning (M365, GitHub, Render)
   - Contract generation
   - Health checks and monitoring
   - Email notifications

4. **üìÅ File Storage Service** (`smartstart-storage`)
   - Document uploads and management
   - Contract storage and generation
   - KYC document handling
   - Image optimization
   - PDF generation
   - QR code generation for verification
   - AWS S3 integration

5. **üìà Monitoring Service** (`smartstart-monitor`)
   - System health checks
   - Performance monitoring
   - Error logging and alerting
   - Service status dashboard
   - Metrics collection
   - Real-time monitoring

6. **üåê Web Frontend** (`smartstart-platform`)
   - Next.js 14 with App Router
   - Dark-themed UI with Tailwind CSS
   - Framer Motion animations
   - Real-time data from API
   - RBAC-based UI components
   - Responsive design

## **üîß Deployment Steps**

### **1. Automatic Deployment (Recommended)**
The platform is configured for automatic deployment via Render.com blueprint:

1. **Fork/Clone Repository**
   ```bash
   git clone https://github.com/udishkolnik/SmartStart.git
   cd SmartStart
   ```

2. **Deploy to Render.com**
   - Go to [Render.com](https://render.com)
   - Click "New Blueprint Instance"
   - Connect your GitHub repository
   - Select the `main` branch
   - Click "Deploy Blueprint"

3. **Environment Variables**
   - All required environment variables are configured in `render.yaml`
   - Secrets are auto-generated by Render
   - External service keys need to be added manually

### **2. Manual Deployment**

#### **Database Setup**
```bash
# Create database
createdb smartstart_local

# Run migrations
npx prisma migrate deploy

# Seed database
npm run db:seed
```

#### **API Server**
```bash
# Install dependencies
npm install

# Set environment variables
export DATABASE_URL="postgresql://user:pass@localhost:5432/smartstart_local"
export JWT_SECRET="your-secret-key"
export NODE_ENV="production"

# Start API server
npm run start:api
```

#### **Background Worker**
```bash
# Start worker service
npm run start:worker
```

#### **File Storage Service**
```bash
# Set AWS credentials
export AWS_ACCESS_KEY_ID="your-aws-key"
export AWS_SECRET_ACCESS_KEY="your-aws-secret"
export AWS_S3_BUCKET="smartstart-files"

# Start storage service
npm run start:storage
```

#### **Monitoring Service**
```bash
# Start monitor service
npm run start:monitor
```

#### **Web Frontend**
```bash
# Set API URL
export NEXT_PUBLIC_API_URL="http://localhost:3001"

# Build and start
npm run build
npm start
```

## **üîó What Happens During Deployment**

### **Database Initialization**
1. PostgreSQL database is created
2. Prisma migrations are applied
3. Initial seed data is loaded:
   - System settings and configurations
   - Default roles and permissions
   - Demo users with hashed passwords
   - Sample skills and badges
   - RBAC mappings

### **Service Startup Sequence**
1. **Database** - PostgreSQL starts and accepts connections
2. **API Server** - Connects to database, starts Express server
3. **Worker** - Connects to database, schedules background jobs
4. **Storage** - Connects to database and AWS S3
5. **Monitor** - Starts health checks and monitoring
6. **Web Frontend** - Builds Next.js app, starts web server

### **Health Checks**
- All services have `/health` endpoints
- Monitor service checks all other services
- Automatic restart on failure
- Performance metrics collection

## **üåç Environment Variables**

### **Database**
```env
DATABASE_URL=postgresql://user:pass@host:5432/database
```

### **API Server**
```env
JWT_SECRET=your-jwt-secret
NEXTAUTH_SECRET=your-nextauth-secret
API_PORT=3001
NODE_ENV=production
STRIPE_SECRET_KEY=sk_test_...
GITHUB_CLIENT_ID=your-github-app-id
GITHUB_CLIENT_SECRET=your-github-secret
M365_CLIENT_ID=your-m365-app-id
M365_CLIENT_SECRET=your-m365-secret
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email
SMTP_PASS=your-email-password
REDIS_URL=redis://localhost:6379
AWS_ACCESS_KEY_ID=your-aws-key
AWS_SECRET_ACCESS_KEY=your-aws-secret
AWS_S3_BUCKET=smartstart-files
AWS_REGION=us-east-1
```

### **Web Frontend**
```env
NEXT_PUBLIC_API_URL=https://smartstart-api.onrender.com
NEXTAUTH_URL=https://smartstart-platform.onrender.com
STRIPE_PUBLISHABLE_KEY=pk_test_...
NEXT_PUBLIC_S3_BUCKET=smartstart-files
NEXT_PUBLIC_AWS_REGION=us-east-1
```

## **‚úÖ Verification**

### **1. Health Checks**
```bash
# API Server
curl https://smartstart-api.onrender.com/api/health

# Storage Service
curl https://smartstart-storage.onrender.com/health

# Monitor Service
curl https://smartstart-monitor.onrender.com/health

# Web Frontend
curl https://smartstart-platform.onrender.com
```

### **2. Database Connection**
```bash
# Test database connection
psql $DATABASE_URL -c "SELECT COUNT(*) FROM \"User\";"
```

### **3. API Endpoints**
```bash
# Login
curl -X POST https://smartstart-api.onrender.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@smartstart.com","password":"admin123"}'

# Get users (with token)
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://smartstart-api.onrender.com/api/users
```

## **üîê Access Points**

### **Production URLs**
- **Web Platform**: https://smartstart-platform.onrender.com
- **API Server**: https://smartstart-api.onrender.com
- **Storage Service**: https://smartstart-storage.onrender.com
- **Monitor Dashboard**: https://smartstart-monitor.onrender.com

### **Demo Credentials**
- **Super Admin**: admin@smartstart.com / admin123
- **Regular User**: user@smartstart.com / user123
- **Project Owner**: owner@demo.local / owner123
- **Contributor**: contrib@demo.local / contrib123

## **üéØ Features Available**

### **API Server Features**
- ‚úÖ JWT Authentication
- ‚úÖ RBAC Authorization
- ‚úÖ User Management
- ‚úÖ Project Management
- ‚úÖ Equity Tracking
- ‚úÖ Task Management
- ‚úÖ System Settings
- ‚úÖ Skills & Badges
- ‚úÖ Background Jobs

### **Worker Service Features**
- ‚úÖ Quarterly Equity Rebalancing
- ‚úÖ Dunning Process
- ‚úÖ IT Pack Provisioning
- ‚úÖ Contract Generation
- ‚úÖ Health Monitoring
- ‚úÖ Email Notifications

### **Storage Service Features**
- ‚úÖ File Upload/Download
- ‚úÖ Document Management
- ‚úÖ Contract Storage
- ‚úÖ Image Optimization
- ‚úÖ PDF Generation
- ‚úÖ QR Code Generation
- ‚úÖ AWS S3 Integration

### **Monitor Service Features**
- ‚úÖ System Health Checks
- ‚úÖ Performance Monitoring
- ‚úÖ Error Logging
- ‚úÖ Service Status Dashboard
- ‚úÖ Metrics Collection
- ‚úÖ Alert Management

### **Web Frontend Features**
- ‚úÖ Dark-themed UI
- ‚úÖ Responsive Design
- ‚úÖ Real-time Data
- ‚úÖ RBAC-based Components
- ‚úÖ Authentication Flow
- ‚úÖ Dashboard Interface

## **üîß Troubleshooting**

### **Common Issues**

1. **Database Connection Failed**
   ```bash
   # Check database status
   psql $DATABASE_URL -c "SELECT 1;"
   
   # Verify environment variables
   echo $DATABASE_URL
   ```

2. **API Server Not Starting**
   ```bash
   # Check logs
   npm run start:api
   
   # Verify dependencies
   npm install
   ```

3. **Frontend Build Failed**
   ```bash
   # Clear cache and rebuild
   rm -rf .next
   npm run build
   ```

4. **Worker Jobs Not Running**
   ```bash
   # Check worker logs
   npm run start:worker
   
   # Verify cron schedules
   # Check database for job records
   ```

### **Logs and Monitoring**
- All services log to console and files
- Monitor service provides centralized logging
- Health check endpoints for each service
- Performance metrics available via API

## **üîí Security Features**

### **Authentication & Authorization**
- JWT-based authentication
- Role-based access control (RBAC)
- Granular permissions system
- Session management
- Account lockout protection

### **Data Protection**
- Password hashing with bcrypt
- HTTPS encryption in production
- Rate limiting on API endpoints
- Input validation and sanitization
- SQL injection protection via Prisma

### **File Security**
- Secure file uploads with validation
- AWS S3 integration for storage
- File type restrictions
- Size limits and optimization
- Access control for downloads

## **üìä Monitoring & Scaling**

### **Health Monitoring**
- Real-time service health checks
- Performance metrics collection
- Error tracking and alerting
- Uptime monitoring
- Resource usage tracking

### **Scaling Considerations**
- Horizontal scaling for API server
- Worker service auto-scaling
- Database connection pooling
- CDN for static assets
- Load balancing support

### **Backup & Recovery**
- Database backups via Render
- File storage redundancy
- Configuration versioning
- Disaster recovery procedures

## **üÜò Support**

### **Documentation**
- [README.md](./README.md) - Complete platform overview
- [API Documentation](./docs/api.md) - API endpoints and usage
- [Database Schema](./prisma/schema.prisma) - Database structure

### **Contact**
- **Platform**: SmartStart Platform
- **Developer**: AliceSolutions
- **Repository**: https://github.com/udishkolnik/SmartStart

### **Issues & Updates**
- Check GitHub Issues for known problems
- Monitor service logs for errors
- Review deployment logs in Render dashboard
- Update dependencies regularly

---

**üéâ Your SmartStart Platform is now fully deployed and ready for use!**
