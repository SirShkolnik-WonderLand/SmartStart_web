LOGGING & MONITORING STANDARD
AliceSolutions Ventures Inc. — Hub & Ventures
Version: 1.0 • Owner: CISO • Effective: on publication

0. PURPOSE & SCOPE
   Define what we **log**, how we **protect and retain** logs, how we **monitor & alert**, and how we **prove** this to auditors. Applies to the Hub platform and all ventures/projects using the standard stack (M365/Entra ID, Intune/Defender, GitHub Org, approved CI/CD, Render.com, Designated Secrets Manager, DB/storage, observability stack). Enforce the **highest data tier** in a project (T0–T3) across all controls.

0.1 REFERENCES (internal)
• Security Controls Master (`security_controls_master.txt`)
• Incident Response Plan (`incident_response_plan.txt`)
• Data Classification Standard (`data_classification_standard.txt`)
• BCP/DR Policy (`bcp_dr_policy.txt`)
• DPA & Per-Project NDA Addendum (tiered controls)

1. ROLES & RESPONSIBILITIES
   • **CISO** — policy owner, approves changes.
   • **SRE Lead** — log pipelines, storage, SIEM rules, dashboards.
   • **Security.Admin** — detections, alert triage, tuning, exception reviews.
   • **Project.Owner / Eng Leads** — app logs, metrics, SLOs, runbooks.
   • **DPO/Privacy** — PII/PHI redaction rules, privacy reviews.
   • **Org.Owner** — ensures funded capacity for retention & monitoring.

2. LOG SOURCES (REQUIRED BY DEFAULT)
   A. **Identity & Collaboration (M365/Entra ID/Teams/Exchange/SharePoint/OneDrive)**

   * Sign-in/Conditional Access; admin role changes; mailbox rules; sharing/forwarding.
     B. **Endpoint & Device (Intune + Defender)**
   * Compliance state; EDR alerts; isolation actions.
     C. **Source Control (GitHub Org)**
   * Auth/SSO; repo creation/deletion; branch protection changes; PRs to protected branches; secret scan alerts; Actions audit.
     D. **CI/CD (approved)**
   * Pipeline runs; artifact digests/signatures; env approvals; secret access events.
     E. **Hosting/Runtime (Render.com)**
   * Deployment events; config changes; service health; autoscale; egress anomalies.
     F. **Secrets Manager**
   * Read/write/rotate events; failed access; policy changes.
     G. **Databases/Storage**
   * Auth; schema changes; admin statements; long-running/large result queries; backup/restore events.
     H. **Application Logs**
   * Structured request logs; errors; authZ decisions; business-critical events.
     I. **DLP & Email Security**
   * DLP hits/blocks; malicious attachments; spoofing; exfil attempts.
     J. **Tickets/Hub Events**
   * Provisioning changes; exceptions; document issue/signature; access reviews.

3. LOG QUALITY & SCHEMA (APPS MUST CONFORM)
   3.1 **Format:** JSON per line. No stack traces across lines.
   3.2 **Required fields (apps):**

```
timestamp (RFC3339Z) | level | service | env | version | instance_id
trace_id | span_id | request_id | user_id (hashed) | authn_method
tenant_id | project_id | route | client_ip (masked) | status | latency_ms
pii_tags[] | error_code | msg
```

3.3 **Correlation:**

* Always populate `trace_id`/`request_id`; propagate through gateways, jobs, queues, CI/CD, and Render deployment hooks.
  3.4 **PII/PHI:**
* Default **no PII** in logs. If unavoidable, tag with `pii_tags` and **mask** (`email` → `e***@example.com`). **Never** log secrets, access tokens, OAuth codes, full card data, or raw documents.
  3.5 **Secrets Redaction:**
* Implement server-side redactors (regex for key formats, bearer tokens, URIs with creds). Reject emits that match “secret-likelies” (fail the request unless `ALLOW_LOG=false`).

4. TRANSPORT, INGEST, STORAGE
   4.1 **Transport:** TLS 1.2+ from source to collector. Use agent/forwarder where native export is unavailable.
   4.2 **Time Sync:** NTP across sources; logs must carry RFC3339Z timestamps.
   4.3 **Ingest SLA:** Hot path delivery ≤ 2 minutes (95th percentile). Queue when rate-limited; back-pressure with drop-proof buffers.
   4.4 **Integrity:** Apply **hash-chain** or platform immutability/WORM for hot storage; copy to **WORM/cold** daily (see 6.4).
   4.5 **Encryption at Rest:** provider KMS or customer-managed keys per tier.

5. ACCESS CONTROL & PRIVACY
   5.1 **Access:**

* **Read:** SecOps, SRE, CISO by default; DPO on request; Project/Eng Leads access **their services only**.
* **Write/Rule-edit:** SRE Lead + Security.Admin.
  5.2 **Data Minimization:** Do not log document content, payloads, or full personal data.
  5.3 **DSAR:** Support lookup by `user_id` (hashed lookup table held separately).
  5.4 **Legal Hold:** Flag indices; extend retention; disable deletion jobs while hold active.

6. RETENTION & RESILIENCE

* **T0 Public:** 90 days hot searchable; 12 months cold archive.
* **T1 Confidential:** 180 days hot; 12 months cold.
* **T2 Restricted:** 12 months hot; 24 months cold (WORM).
* **T3 Highly Restricted / PHI:** 12 months hot; 36 months cold (WORM); access reviewed monthly.
  6.1 **Backups of Logs:** Daily snapshots of indices/configs.
  6.2 **Restore Tests:** Quarterly sample restore drills (tie to IRP).
  6.3 **Cold Store:** Object storage with object lock/WORM + lifecycle; checksum verified on write.
  6.4 **Index Lifecycle:** Hot → Warm → Cold → Delete (per tier). Document in runbook.

7. MONITORING: METRICS, SLOs, HEALTH
   7.1 **Pipeline Health SLOs:**

* Ingest delay p95 ≤ 2 min (hot); error rate ≤ 0.1%; dropped events = 0.
* Alert latency p95 ≤ 3 min for Sev-1/2 detections.
  7.2 **Service SLOs (per app):** define **availability**, **latency**, **error budget**; publish to dashboard.
  7.3 **Runbooks:** Every alert must link a named runbook (owner, steps, rollback).

8. ALERTING & SEVERITY
   Map detections to IRP severities. Default channel: `#sec-alerts` (auto-route to project channels as needed). **No alert without an owner and runbook.**

9. DETECTION CATALOG (MINIMUM SET)
   (✓ = default enabled; T = tier prerequisite)

**Identity / Entra ID / M365**

* ✓ Impossible travel or impossible device posture → Sev-2.
* ✓ Admin role assignment or privileged app consent → Sev-2.
* ✓ Creation of forwarding mailbox rules / external auto-forward → Sev-2 (exfil).
* ✓ Conditional Access policy change → Sev-2.
* ✓ Break-glass account sign-in → Sev-1.

**Endpoint / Intune + Defender**

* ✓ Device becomes non-compliant (enforced block) → Sev-3; escalate to Sev-2 if accessing T2/T3.
* ✓ High-severity malware alert / ransomware behavior → Sev-1.
* ✓ Defender sensor disabled or EDR off → Sev-2 (T2/T3: Sev-1).

**GitHub Org**

* ✓ SSO enforcement disabled / bypass attempt → Sev-1.
* ✓ Branch protection changed on protected branch → Sev-2.
* ✓ Secret scanning alert (valid credential) → Sev-1; auto-rotate.
* ✓ Force-push to protected branch → Sev-2.
* ✓ New repo marked public within venture scope → Sev-2.

**CI/CD**

* ✓ Deployment to prod without approved pipeline → Sev-2.
* ✓ Artifact digest mismatch / unsigned artifact in prod → Sev-1.
* ✓ Secret access in CI from non-approved job → Sev-2.

**Render.com / Runtime**

* ✓ Config change (env vars, service settings) outside change window → Sev-2.
* ✓ Sudden egress spike (x5 baseline) → Sev-2 (possible exfil).
* ✓ CrashLoop or health check failures above threshold → Sev-3 (SRE owns).

**Secrets Manager**

* ✓ Access to secret from unexpected principal or region → Sev-2.
* ✓ Stale secret (> rotation window per tier) → Sev-3 (compliance).

**Database/Storage**

* ✓ Admin statements in off-hours (DDL/DCL) → Sev-2.
* ✓ Large export/select (over policy) to external IP → Sev-1.
* ✓ Backup job failure or restore attempt outside change window → Sev-2.

**DLP & Email Security**

* ✓ Blocked DLP exfil (sensitive label) → Sev-2.
* ✓ Spike in spoofed/malicious attachments → Sev-3 (raise to Sev-2 if user clicked).

**Hub / Governance**

* ✓ Time-boxed exception expired → Sev-3 (auto-revoke).
* ✓ Access review not completed by due date → Sev-3.

10. ALERT THRESHOLDS & TUNING (DEFAULTS)

* **Egress spike:** mean over last 7 days per service; alert at `current > 5× mean & > 1GB in 10 min`.
* **Login failures:** alert when `>50 failures / 5 min / tenant` and distinct IPs `>10`.
* **5xx error rate:** `>2% / 5 min` Sev-3; `>10% / 5 min` Sev-2.
* **Queue backlog:** `>10× normal p95 processing time` Sev-2.
* **DB long query:** `>30s` on prod (whitelist migrations).
* **CPU/Mem saturation:** `>90% / 15 min` Sev-3 unless known batch window.

11. SAMPLE QUERIES (REFERENCE)
    (Adapt to your SIEM/query language. Use `{}` placeholders.)

**Entra ID — impossible travel (KQL-style):**

```
SigninLogs
| where ResultType == 0
| summarize make_set(ClientAppUsed), makeset(IPAddress), min(TimeGenerated), max(TimeGenerated) by UserPrincipalName, bin(TimeGenerated, 1h)
| invoke calculate_geovelocity(...) // org function: flags >900 km/h between IP geos
| where geovelocity_kmh > 900
```

**M365 — mailbox forwarding rules created:**

```
AuditLogs
| where Operation in ("New-InboxRule","Set-Mailbox")
| where Parameters contains "ForwardTo" or Parameters contains "ForwardingSmtpAddress"
```

**GitHub — branch protection changed:**

```
GitHubAudit
| where action == "branch_protection_rule.update"
| where repo in ({venture_repos})
```

**GitHub — secret scanning (valid):**

```
GitHubSecretAlerts
| where state == "open" and validity == "valid"
```

**CI/CD — unsigned artifact to prod:**

```
DeployEvents
| where environment == "prod" and artifact_signature_verified == false
```

**Render — config change outside window:**

```
RenderAudit
| where actor != "pipeline" and (timestamp between (start_of_offhours .. end_of_offhours))
| where change_kind in ("ENV_VAR_UPDATE","SERVICE_SETTING_UPDATE")
```

**DB — large export:**

```
DbQueryLogs
| where bytes_returned > 500000000 and not( client_ip in {office_ips} )
```

**App — authZ deny spikes:**

```
AppLogs
| where level == "WARN" and msg == "authz_denied"
| summarize count() by project_id, bin(timestamp, 5m)
| where count_ > 100
```

12. DASHBOARDS (MINIMUM)

* **Security Overview:** open Sev-1/2, last 24h alerts, incident MTTA/MTTR, DLP trend.
* **Identity:** sign-ins, failed sign-ins, risky sign-ins, admin changes, break-glass usage.
* **Endpoint:** compliance, EDR alerts, isolates, top offending hosts.
* **Code/CI:** open secret alerts, PR latency, protected branch events, unsigned artifacts.
* **Runtime:** 5xx, latency, saturation, egress, deploys by env.
* **DB/Storage:** long queries, schema/admin changes, backup success, restore tests.
* **Compliance:** access review completion, exception expiry, log ingestion SLO, retention status by tier.

13. RUNBOOK REQUIREMENTS (FOR EVERY ALERT)
    Each alert must link to `/documentation/engineering/runbooks/*` and state: **owner**, **context**, **impact**, **checks**, **containment**, **remediation**, **rollback**, **communications**, **when to escalate to IRP**.

14. COST & CARDINALITY GUARDRAILS

* Cap label cardinality: avoid high-cardinality fields (raw user IDs) in metrics; hash where needed.
* Sampling for noisy traces; never sample **security-critical** events.
* Budgets: keep ingest < planned quota; emit warnings at 80%, block at 100% (non-security indices first).

15. TESTING & DRILLS

* **Quarterly**: end-to-end test — synth auth anomaly → alert → IR channel → ticket → close.
* **Quarterly**: restore a random log index to prove recoverability.
* **Monthly**: false-positive review; tune or retire alerts; record decisions.

16. CHANGE MANAGEMENT

* Detection rules, parsers, and dashboards live in repo under `/observability/`.
* Changes via PR; reviewers: SRE Lead + Security.Admin; version rules with semantic versioning.
* Tag releases; generate change notes for audit.

17. EVIDENCE FOR AUDITORS

* Export: list of enabled data sources, retention configs, index lifecycles, sample log lines, alert definitions, dashboard screenshots, drill reports, restore proofs, and PIR links.
* Provide **hash** or immutable store reference for tamper-evidence.

18. EXCEPTIONS

* Any request to disable a required source or reduce retention is an **Exception** in `security/exception_log_template.csv`, approved by CISO (and Legal/DPO if privacy/residency affected), time-boxed **≤ 90 days**.

19. MAPPINGS

* ISO/IEC 27001:2022 Annex A: A.5.24–A.5.26, A.8.16–A.8.18, A.8.28–A.8.32
* SOC 2 TSC: CC6.7, CC7.2–CC7.4, A1, C1
* Privacy (PIPEDA/PHIPA): safeguard appropriate to sensitivity; breach records via IRP.

20. VERSIONING & NEXT REVIEW

* PR-based updates; CISO approval required.
* Next formal review **12 months** from effective date or after any Sev-1 incident.

CHANGE LOG
• v1.0 — Initial standard aligned to IRP and Security Controls Master.
